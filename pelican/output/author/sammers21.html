<!DOCTYPE html>
<html lang="en_us">
<head>
        <meta charset="utf-8" />
        <title>@Sammers21 - Sammers21</title>
        <link rel="stylesheet" href="/theme/css/main.css" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">@Sammers21 </a></h1>
                <nav><ul>
                    <li><a href="/category/gsoc.html">GSoC</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="/how-i-can-use-vertx-mqtt-cleint.html">How I can use Vert.x MQTT cleint?</a></h1>
<footer class="post-info">
        <abbr class="published" title="2017-07-23T00:00:00+02:00">
                Published: Sun 23 July 2017
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/sammers21.html">Sammers21</a>
        </address>
<p>In <a href="/category/gsoc.html">GSoC</a>.</p>

</footer><!-- /.post-info --><p>The thing I would like to tell you about in this article is set upping Vert.x MQTT client. Actually, I have a <a href="https://github.com/Sammers21/vertx-mqtt-client-example">real example</a> so you can try it quickly.</p>
<p>If you are using Maven or Gradle, add the following dependency to the dependencies section of your project descriptor to access the Vert.x MQTT client:</p>
<ul>
<li>Maven (in your pom.xml):</li>
</ul>
<div class="highlight"><pre><span></span><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>io.vertx<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>vertx-mqtt-client<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>3.5.0-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></div>


<ul>
<li>Gradle (in your build.gradle file):</li>
</ul>
<div class="highlight"><pre><span></span><span class="n">dependencies</span> <span class="o">{</span>
  <span class="n">compile</span> <span class="s1">&#39;io.vertx:vertx-core:3.4.2&#39;</span>
<span class="o">}</span>
</pre></div>


<p>The Vert.x MQTT client will be released on 04 August with Vert.x 3.5.0 release, so artifact cant be downloaded from Maven central for now and you should install artifact locally. To do so execute this:</p>
<div class="highlight"><pre><span></span>git clone https://github.com/Sammers21/vertx-mqtt-client
<span class="nb">cd</span> vertx-mqtt-client
mvn clean install
</pre></div>


<p>Now that you’ve set up your project, you can create a simple application which will receive all messages from all broker channels:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">io.vertx.core.AbstractVerticle</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.vertx.mqtt.MqttClient</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.vertx.mqtt.MqttClientOptions</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.UnsupportedEncodingException</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainVerticle</span> <span class="kd">extends</span> <span class="n">AbstractVerticle</span> <span class="o">{</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">start</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">MqttClientOptions</span> <span class="n">options</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MqttClientOptions</span><span class="o">()</span>
      <span class="c1">// specify broker host</span>
      <span class="o">.</span><span class="na">setHost</span><span class="o">(</span><span class="s">&quot;iot.eclipse.org&quot;</span><span class="o">);</span>

    <span class="n">MqttClient</span> <span class="n">client</span> <span class="o">=</span> <span class="n">MqttClient</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">vertx</span><span class="o">,</span> <span class="n">options</span><span class="o">);</span>

    <span class="n">client</span><span class="o">.</span><span class="na">publishHandler</span><span class="o">(</span><span class="n">s</span> <span class="o">-&gt;</span> <span class="o">{</span>
      <span class="k">try</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">message</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">s</span><span class="o">.</span><span class="na">payload</span><span class="o">().</span><span class="na">getBytes</span><span class="o">(),</span> <span class="s">&quot;UTF-8&quot;</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">&quot;Receive message with content: \&quot;%s\&quot; from topic \&quot;%s\&quot;&quot;</span><span class="o">,</span> <span class="n">message</span><span class="o">,</span> <span class="n">s</span><span class="o">.</span><span class="na">topicName</span><span class="o">()));</span>
      <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">UnsupportedEncodingException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
      <span class="o">}</span>
    <span class="o">});</span>

    <span class="n">client</span><span class="o">.</span><span class="na">connect</span><span class="o">(</span><span class="n">s</span> <span class="o">-&gt;</span> <span class="o">{</span>
      <span class="c1">// subscribe to all subtopics</span>
      <span class="n">client</span><span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="s">&quot;#&quot;</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
    <span class="o">});</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>The <strong>publishHandler</strong> is the handler called each time the broker, located at iot.eclipse.org:1883, send a message to you, from the topics you subscribing for.</p>
<p>But just providing a handler is not enough, you should also connect to the broker and subscribe to some topics. For this reason, you should use a <strong>connect</strong> method and then call <strong>subscribe</strong> when connection established. </p>
<p>To deploy this verticle form typical application you should have in your <strong>main</strong> method something like that:</p>
<div class="highlight"><pre><span></span><span class="n">Vertx</span> <span class="n">vertx</span> <span class="o">=</span> <span class="n">Vertx</span><span class="o">.</span><span class="na">vertx</span><span class="o">();</span>
<span class="n">vertx</span><span class="o">.</span><span class="na">deployVerticle</span><span class="o">(</span><span class="n">MainVerticle</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getCanonicalName</span><span class="o">());</span>
</pre></div>


<p>If you have completed all steps correctly the result should look like that:</p>
<p><img alt="" src="http://i.imgur.com/b4yYQJE.gif"></p>
<p>As the alternative and recommended way to bootstrap Vert.x applications you can use <a href="https://github.com/vert-x3/vertx-maven-starter">vertx-maven-starter</a> or <a href="https://github.com/vert-x3/vertx-gradle-starter">vertx-gradle-starter</a>. For completing this guide I have used the first one. The final source code available <a href="https://github.com/Sammers21/vertx-mqtt-client-example">here</a>. If you would like to learn more about Vert.x MQTT client API then check out the <a href="https://github.com/vert-x3/vertx-mqtt-client/blob/initial-work/src/main/asciidoc/java/index.adoc">full documentation</a>. </p>
<p>Thank you for reading my blog!</p>
<p>Cheers!</p>                </article>
            </aside><!-- /#featured -->
                <section id="content" class="body">
                    <h1>Other articles</h1>
                    <hr />
                    <ol id="posts-list" class="hfeed">

            <li><article class="hentry">
                <header>
                    <h1><a href="/last-week-changes-in-vertx-mqtt-client-1.html" rel="bookmark"
                           title="Permalink to Last week changes in Vert.x MQTT client #1">Last week changes in Vert.x MQTT client #1</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2017-07-16T00:00:00+02:00">
                Published: Sun 16 July 2017
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/sammers21.html">Sammers21</a>
        </address>
<p>In <a href="/category/gsoc.html">GSoC</a>.</p>

</footer><!-- /.post-info -->                <h2>Intro</h2>
<p>In this post, I will just inform you about things happened last week in Vert.x MQTT client.</p>
<h1>New NetClient API</h1>
<p>First thing is about changes in the internal structure of MQTT client. The client itself based on NetClient and any changes in NetClient will cause the similar ones …</p>
                <a class="readmore" href="/last-week-changes-in-vertx-mqtt-client-1.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/introduction-to-vertx-mqtt-client.html" rel="bookmark"
                           title="Permalink to Introduction to vertx-mqtt-client">Introduction to vertx-mqtt-client</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2017-07-09T00:00:00+02:00">
                Published: Sun 09 July 2017
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/sammers21.html">Sammers21</a>
        </address>
<p>In <a href="/category/gsoc.html">GSoC</a>.</p>

</footer><!-- /.post-info -->                <h1>Intro</h1>
<p>I am an GSoC 2017 student and the project I'm working on is an MQTT client for Vert.x JVM toolkit. It designed in Vert.x ideology, which also means, that all operations are non blocking and you, as a user, can be notified when some event happens.</p>
<p>In …</p>
                <a class="readmore" href="/introduction-to-vertx-mqtt-client.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/welcome.html" rel="bookmark"
                           title="Permalink to Welcome">Welcome</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2017-07-08T00:00:00+02:00">
                Published: Sat 08 July 2017
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/sammers21.html">Sammers21</a>
        </address>
<p>In <a href="/category/gsoc.html">GSoC</a>.</p>

</footer><!-- /.post-info -->                <p>Hello anyone who read my blog.</p>
                <a class="readmore" href="/welcome.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>
                </ol><!-- /#posts-list -->
                </section><!-- /#content -->
        <section id="extras" class="body">
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="https://twitter.com/titantins">Twitter</a></li>
                            <li><a href="https://github.com/Sammers21">Github</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>